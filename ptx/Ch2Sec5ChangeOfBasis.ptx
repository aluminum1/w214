

<section xml:id="Ch2Sec5ChangeOfBasis">
  <title>Change of basis</title>
  <subsection>
    <title>Coordinate vectors are different in different bases</title>
    <p>
      Suppose that <m>\basis{B} = \bopen \ve{b}_1, \ve{b}_2 \bclose</m> and
      <m>\basis{C} = \bopen \ve{c}_1, \ve{c}_2 \bclose</m> are two different bases for <m>\mathbb{R}^2</m>,
      shown below:
    </p>

    <figure xml:id="w_in_different_bases">
      <caption>Two different bases for <m>\mathbb{R}^2</m></caption>
      <me>

        <image>

<latex-image>
          <![CDATA[\begin{tikzpicture}[scale=0.4]
  \draw[very thick, red, ->] (0,0) -- node[pos=1.3] {\(\ve{b}_1\)} (2,1); 
  \draw[very thick, red, ->] (0,0) -- node[pos=1.3] {\(\ve{b}_2\)} (1,2);\end{tikzpicture}]]>
</latex-image>
        </image>

      </me>
      \subcaption{The basis <m>\basis{B} = \bopen \ve{b}_1, \ve{b}_2 \bclose</m>}
      <me>

        <image>

<latex-image>
          <![CDATA[\begin{tikzpicture}[scale=0.4]
  \draw[very thick, blue, ->] (0,0) -- node[pos=1.5] {\(\ve{c}_1\)} (1,0); 
  \draw[very thick, blue, ->] (0,0) -- node[pos=1.5] {\(\ve{c}_2\)} (-1,1);\end{tikzpicture}]]>
</latex-image>
        </image>

      </me>
      \subcaption{The basis <m>\basis{C} = \bopen \ve{c}_1, \ve{c}_2 \bclose</m>}
    </figure>

    <p>
      Suppose we are given a vector <m>\ve{w} \in \mathbb{R}^2</m>:
      <me>

        <image>

<latex-image>
          <![CDATA[\begin{tikzpicture}[scale=0.4]
   \draw[thick, ->] (0,0) -- node[pos=1.3] {\(\ve{w}\)} (-4, 1);\end{tikzpicture}]]>
</latex-image>
        </image>

      </me>
    </p>

    <p>
      We would like to compute the coordinate vector of the <em>same</em>
      vector <m>\ve{w}</m> with respect to the two different bases
      <m>\basis{B}</m> and <m>\basis{C}</m>.
    </p>

    <p>
      For this particular <m>\ve{w}</m>,
      from <xref ref="w_in_different_bases">Figure</xref>(a),
      we see that in the basis <m>\basis{B}</m>, we have
      <men>
        \ve{w} = -3 \ve{b}_1 + 2 \ve{b}_2 \qquad \therefore \, [\ve{w}]_\basis{B} = \cvector{-3 \\ 2}  \,
      </men>.
    </p>

    <p>
      On the other hand, in the basis <m>\basis{C}</m>, we have
      <men xml:id="correct_exp_w">
        \ve{w} = \ve{c}_1 - 3\ve{c}_2 \qquad \therefore \, [\ve{w}]_\basis{C} = \cvector{1 \\ -3}
      </men>.
      tikzalign
    </p>

    <figure>

      <image>

<latex-image>
          <![CDATA[\begin{tikzpicture}[scale=0.5]
  \draw[red, dotted] (-9, -9) -- (3, -3);
  \draw[red, dotted] (-8, -7) -- (4, -1);
  \draw[red, dotted] (-7, -5) -- (5, 1);
  \draw[red, dotted] (-6, -3) -- (6, 3);
  \draw[red, dotted] (-5, -1) -- (7, 5);
  \draw[red, dotted] (-4, 1) -- (8, 7);
  \draw[red, dotted] (-3, 3) -- (9, 9);

  \draw[red, dotted] (-9, -9) -- (-3, 3);
  \draw[red, dotted] (-7, -8) -- (-1, 4);
  \draw[red, dotted] (-5, -7) -- (1, 5);
  \draw[red, dotted] (-3, -6) -- (3, 6);
  \draw[red, dotted] (-1, -5) -- (5, 7);
  \draw[red, dotted] (1, -4) -- (7, 8);
  \draw[red, dotted] (3, -3) -- (9, 9);

  \draw[very thick, red, ->] (0,0) -- node[pos=1.3] {\(\ve{b}_1\)} (2,1); 
  \draw[very thick, red, ->] (0,0) -- node[pos=1.3] {\(\ve{b}_2\)} (1,2);
  \draw[thick, ->] (0,0) -- node[pos=1.2] {\(\ve{w}\)} (-4,1);\end{tikzpicture}]]>
</latex-image>
      </image>

      \subcaption{<m>\ve{w} = -3 \ve{b}_1 + 2 \ve{b}_2</m>}

      <image>

<latex-image>
          <![CDATA[\begin{tikzpicture}[scale=0.5]
  \draw[blue, dotted] (-6, 3) -- (0, -3);
  \draw[blue, dotted] (-5, 3) -- (1, -3);
  \draw[blue, dotted] (-4, 3) -- (2, -3);
  \draw[blue, dotted] (-3, 3) -- (3, -3);
  \draw[blue, dotted] (-2, 3) -- (4, -3);
  \draw[blue, dotted] (-1, 3) -- (5, -3);
  \draw[blue, dotted] (-0, 3) -- (6, -3);

  \draw[blue, dotted] (-6, 3) -- (0, 3);
  \draw[blue, dotted] (-5, 2) -- (1, 2);
  \draw[blue, dotted] (-4, 1) -- (2, 1);
  \draw[blue, dotted] (-3, 0) -- (3, 0);
  \draw[blue, dotted] (-2, -1) -- (4, -1);
  \draw[blue, dotted] (-1, -2) -- (5, -2);
  \draw[blue, dotted] (0, -3) -- (6, -3);

  \draw[very thick, blue, ->] (0,0) -- node[pos=1.6] {\(\ve{c}_2\)} (1,0); 
  \draw[very thick, blue, ->] (0,0) -- node[pos=1.6] {\(\ve{c}_1\)} (-1,1);
  \draw[thick, ->] (0,0) -- node[pos=1.2] {\(\ve{w}\)} (-4,1);\end{tikzpicture}]]>
</latex-image>
      </image>

      \subcaption{<m>\ve{w} = \ve{c}_1 - 3 \ve{c}_2</m>}
    </figure>

    <p>
      So, the <em>same</em> vector <m>\ve{w}</m> has different coordinate vectors <m>[\ve{w}]_\basis{B}</m> and
      <m>[\ve{w}]_\basis{C}</m> with respect to the bases
      <m>\basis{B}</m> and <m>\basis{C}</m>!
    </p>
  </subsection>

  <subsection>
    <title>Changing from one basis to another</title>
    <p>
      Now, suppose we only knew <m>[\ve{w}]_\basis{B}</m>,
      the coordinate vector of <m>\ve{w}</m> in the basis <m>\basis{B}</m>.
      In other words, suppose we only knew that
      <me>
        [\ve{w}]_\basis{B} = \cvector{-3 \\ 2} 
      </me>,
      that is, <m>\ve{w} = -3 \ve{b}_1 + 2 \ve{b}_2</m>.
      How could we compute <m>[\ve{w}]_\basis{C}</m>,
      the coordinate vector of <m>\ve{w}</m> in the basis <m>\basis{C}</m>?
    </p>

    <p>
      The best way is to express each vector in the basis
      <m>\basis{B}</m> as a linear combination of the basis vectors in <m>\basis{C}</m>.
      In the next figure, the vectors <m>\ve{b}_1</m> and
      <m>\ve{b}_2</m> are displayed against the background of the basis <m>\basis{C}</m>:
      tikzalign
    </p>

    <image>

<latex-image>
          <![CDATA[\begin{tikzpicture}[scale=0.5]

  \draw[blue, dotted] (-6, 3) -- (0, -3);
  \draw[blue, dotted] (-5, 3) -- (1, -3);
  \draw[blue, dotted] (-4, 3) -- (2, -3);
  \draw[blue, dotted] (-3, 3) -- (3, -3);
  \draw[blue, dotted] (-2, 3) -- (4, -3);
  \draw[blue, dotted] (-1, 3) -- (5, -3);
  \draw[blue, dotted] (-0, 3) -- (6, -3);

  \draw[blue, dotted] (-6, 3) -- (0, 3);
  \draw[blue, dotted] (-5, 2) -- (1, 2);
  \draw[blue, dotted] (-4, 1) -- (2, 1);
  \draw[blue, dotted] (-3, 0) -- (3, 0);
  \draw[blue, dotted] (-2, -1) -- (4, -1);
  \draw[blue, dotted] (-1, -2) -- (5, -2);
  \draw[blue, dotted] (0, -3) -- (6, -3);

  \draw[very thick, blue, ->] (0,0) -- node[pos=1.6] {\(\ve{c}_2\)} (1,0); 
  \draw[very thick, blue, ->] (0,0) -- node[pos=1.6] {\(\ve{c}_1\)} (-1,1);
  \draw[very thick, red, ->] (0,0) -- node[pos=1.3] {\(\ve{b}_1\)} (2,1); 
  \draw[very thick, red, ->] (0,0) -- node[pos=1.3] {\(\ve{b}_2\)} (1,2);\end{tikzpicture}]]>
</latex-image>
    </image>

    <p>
      We read off that:
      <md>
        <mrow>\ve{b}_1 \amp = \ve{c}_1 + 3 \ve{c}_2</mrow>
        <mrow>\ve{b}_2 \amp = 2 \ve{c}_1 + 3 \ve{c}_2</mrow>
      </md>
    </p>

    <p>
      Therefore, we compute:
      <md>
        <mrow>\ve{w} \amp = -3 \ve{b}_1 + 2 \ve{b}_2</mrow>
        <mrow>\amp = -3 (\ve{c}_1 + 3 \ve{c}_2) + 2(2 \ve{c}_1 + 3 \ve{c}_2)</mrow>
        <mrow>\amp = \ve{c}_1 - 3 \ve{c}_2</mrow>
      </md>
    </p>

    <p>
      From this we read off that
      <men xml:id="w_in_basis_C">
        [\ve{w}]_\basis{C} = \cvector{1 \\ -3}
      </men>
      which is the right answer, as we know from <xref ref="correct_exp_w" />.
    </p>

    <p>
      In fact, this calculation can be phrased in terms of matrices.
    </p>

    <definition>
      <statement>
        <p>
          Let <m>\basis{B} = \bopen \ve{b}_1, \ldots, \ve{b}_n \bclose</m> and
          <m>\basis{C} = \bopen \ve{c}_1, \ldots, \ve{c}_n \bclose</m> be bases for a vector space <m>V</m>.
          The <term>change-of-basis matrix from
          <m>\basis{B}</m> to <m>\basis{C}</m></term>
          is the <m>n \times n</m> matrix whose columns are the coordinate vectors <m>[\ve{b}_1]_\basis{C}, \ldots, [\ve{b}_n]_\basis{C}</m>:
          <me>
            \mat{P}_{\basis{C} \leftarrow \basis{B}} := \left[ \cvector{ \\ \ve{b}_1 \\}_\basis{C} \,  \cvector{ \\ \ve{b}_2 \\}_\basis{C} \, \cdots \, \cvector{ \\ \ve{b}_n \\}_\basis{C}\right]
          </me>
        </p>
      </statement>
    </definition>

    <example>
      <statement>
        <p>
          In our running example,
          we see from <xref ref="b_in_terms_of_c" /> and <xref ref="b_in_terms_of_c_2" /> that
          <me>
            [\ve{b}_1]_\basis{C} = \cvector{1 \\ 3},  [\ve{b}_2]_\basis{C} = \cvector{2 \\ 3} \, 
          </me>.
        </p>

        <p>
          Hence the change-of-basis matrix from
          <m>\basis{B}</m> to <m>\basis{C}</m> is
          <md>
            \mat{P}_{\basis{C} \leftarrow \basis{B}} = \cmatrix{ 1 \amp  2 \\ 3 \amp  3} \, .
          </md>
        </p>
      </statement>
    </example>

    <p>
      Before we move on,
      we need to recall something about matrix multiplication.
      Suppose you collect together <m>m</m> column vectors to form a matrix:
      <me>
        \left[ \begin{aligned}

        <image>

<latex-image>
          <![CDATA[\begin{tikzpicture}[scale=0.5] \draw (0,0) rectangle (1,3); \node at (0.5, 1.5) {\(\mat{C}_1\)};\end{tikzpicture}]]>
</latex-image>
        </image>

        \end{aligned}  
        \begin{aligned}

        <image>

<latex-image>
          <![CDATA[\begin{tikzpicture}[scale=0.5] \draw (0,0) rectangle (1,3); \node at (0.5, 1.5) {\(\mat{C}_2\)};\end{tikzpicture}]]>
</latex-image>
        </image>

        \end{aligned}  
        \cdots 
        \begin{aligned}

        <image>

<latex-image>
          <![CDATA[\begin{tikzpicture}[scale=0.5] \draw (0,0) rectangle (1,3); \node at (0.5, 1.5) {\(\mat{C}_m\)};\end{tikzpicture}]]>
</latex-image>
        </image>

        \end{aligned}  \right]
      </me>
    </p>

    <p>
      (For instance, our change-of-basis matrix
      <m>\mat{P}_{\basis{C} \leftarrow \basis{B}}</m> was formed in this way.) Then the product of this matrix with a column vector can be computed as follows:
      <men xml:id="column_vector_multiplication">
        \left[ \begin{aligned}

        <image>

<latex-image>
          <![CDATA[\begin{tikzpicture}[scale=0.5] \draw (0,0) rectangle (1,3); \node at (0.5, 1.5) {$\mat{C}_1$};\end{tikzpicture}]]>
</latex-image>
        </image>

        \end{aligned} 
        \begin{aligned}

        <image>

<latex-image>
          <![CDATA[\begin{tikzpicture}[scale=0.5] \draw (0,0) rectangle (1,3); \node at (0.5, 1.5) {$\mat{C}_2$};\end{tikzpicture}]]>
</latex-image>
        </image>

        \end{aligned} 
        \cdots 
        \begin{aligned}

        <image>

<latex-image>
          <![CDATA[\begin{tikzpicture}[scale=0.5] \draw (0,0) rectangle (1,3); \node at (0.5, 1.5) {$\mat{C}_m$};\end{tikzpicture}]]>
</latex-image>
        </image>

        \end{aligned} \right] \left[ \begin{array}{c} a_1 \\ a_2 \\ \vdots \\ a_m \end{array} \right] = a_1  \begin{aligned}

        <image>

<latex-image>
          <![CDATA[\begin{tikzpicture}[scale=0.5] \draw (0,0) rectangle (1,3); \node at (0.5, 1.5) {$\mat{C}_1$};\end{tikzpicture}]]>
</latex-image>
        </image>

        \end{aligned} + a_2  
        \begin{aligned}

        <image>

<latex-image>
          <![CDATA[\begin{tikzpicture}[scale=0.5] \draw (0,0) rectangle (1,3); \node at (0.5, 1.5) {$\mat{C}_2$};\end{tikzpicture}]]>
</latex-image>
        </image>

        \end{aligned} + \cdots + a_n 
        \begin{aligned}

        <image>

<latex-image>
          <![CDATA[\begin{tikzpicture}[scale=0.5] \draw (0,0) rectangle (1,3); \node at (0.5, 1.5) {$\mat{C}_m$};\end{tikzpicture}]]>
</latex-image>
        </image>

        \end{aligned}
      </men>
    </p>

    <exercise>
      <statement>
        <p>
          Prove the above formula!
        </p>
      </statement>
    </exercise>

    <p>
      We can now prove the following theorem.
    </p>

    <theorem xml:id="change-of-basis-thm">
      <title>Change of basis</title>
      <statement>
        <p>
          Suppose that <m>\basis{B} = \bopen \ve{b}_1, \ldots, \ve{b}_n\bclose</m> and
          <m>\basis{C} = \bopen \ve{c}_1, \ldots, \ve{c}_n \bclose</m> are bases for a vector space <m>V</m>,
          and let <m>\mat{P}_{\basis{C} \leftarrow \basis{B}}</m> be the change-of-basis matrix from <m>\basis{B}</m> to <m>\basis{C}</m>.
          Then for all vectors <m>\ve{v}</m> in <m>V</m>,
          <men xml:id="change-of-basis-in-action">
            [\ve{v}]_\basis{C} = \mat{P}_{\basis{C} \leftarrow \basis{B}} [\ve{v}]_\basis{B} 
          </men>.
        </p>
      </statement>
    </theorem>

    <proof>
      <p>
        Let <m>\ve{v} \in V</m>.
        Expand it in the basis <m>\basis{B}</m>:
        <me>
          \ve{v} = a_1 \ve{b}_1 + a_2 \ve{b}_2 + \cdots + a_n \ve{b}_n,  \mbox{i.e. }  [\ve{v}]_\basis{B} = \cvector{a_1 \\ \vdots \\ a_n}
        </me>.
      </p>

      <p>
        Then,
        <md>
          <mrow>_\basis{C} \amp = [a_1 \ve{b}_1 + \cdots + a_n \ve{b}_n]_\basis{C}</mrow>
          <mrow>\amp = a_1 [\ve{b}_1]_\basis{C} + \cdots + a_n [\ve{b}_n]_\basis{C}  \amp \amp  \mbox{(by <xref ref="lin_of_coord_vectors">Lemma</xref>)}</mrow>
          <mrow>\amp = \left[ \cvector{</mrow>
          <mrow>\ve{b}_1</mrow>
          <mrow>}_\basis{C} \,  \cvector{</mrow>
          <mrow>\ve{b}_2</mrow>
          <mrow>}_\basis{C} \, \cdots \, \cvector{</mrow>
          <mrow>\ve{b}_n</mrow>
          <mrow>}_\basis{C}\right] \cvector{a_1</mrow>
          <mrow>\vdots</mrow>
          <mrow>a_n} \amp \amp  \mbox{(by (3.5.6))}</mrow>
          <mrow>\amp =    \mat{P}_{\basis{C} \leftarrow \basis{B}} [\ve{v}]_\basis{B} \, </mrow>
        </md>.
      </p>
    </proof>

    <example>
      <statement>
        <p>
          In our running example, the theorem says that for <em>any</em>
          vector <m>\ve{v} \in \mathbb{R}^2</m>,
          <md>
            [\ve{v}]_\basis{C} = \cmatrix{1 \amp  2 \\ 3 \amp  3} [\ve{v}]_\basis{B} .
          </md>
        </p>

        <p>
          In particular, this must hold for our vector <m>\ve{w}</m>,
          whose coordinate vector in the basis <m>\ve{B}</m> was:
          <me>
            [\ve{w}]_\basis{B} = \cvector{ -3 \\ 2} 
          </me>.
        </p>

        <p>
          So in this case, the theorem is saying that
          <md>
            [\ve{w}]_{\basis{C}} = \cmatrix{1 \amp  2 \\ 3 \amp  3} \cvector{-3 \\ 2}  = \cvector{1 \\ -3}
          </md>
          which agrees with our previous calculation <xref ref="w_in_basis_C" />!
        </p>
      </statement>
    </example>
  </subsection>
</section>

